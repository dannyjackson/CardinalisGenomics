# trimming

module load bwa

bwa index /xdisk/mcnew/dannyjackson/cardinals/reference_dataset/ncbi_dataset/data/GCA_013397215.1/GCA_013397215.1_ASM1339721v1_genomic.fna

MSB_25201_CKDN230006131-1A_H5LY7DSX7_L2_1.fq.gz
MSB_25201_CKDN230006131-1A_H5LY7DSX7_L2_2.fq.gz
NOCA_003_CKDN230006108-1A_H5LY7DSX7_L1_1.fq.gz
NOCA_003_CKDN230006108-1A_H5LY7DSX7_L1_2.fq.gz
NOCA_004_1.fq.gz
NOCA_004_2.fq.gz
NOCA_006_CKDN230006110-1A_H5LY7DSX7_L1_1.fq.gz
NOCA_006_CKDN230006110-1A_H5LY7DSX7_L1_2.fq.gz
NOCA_008_CKDN230006111-1A_H5MT2DSX7_L1_1.fq.gz
NOCA_008_CKDN230006111-1A_H5MT2DSX7_L1_2.fq.gz
NOCA_012_CKDN230006112-1A_H5LY7DSX7_L1_1.fq.gz
NOCA_012_CKDN230006112-1A_H5LY7DSX7_L1_2.fq.gz
NOCA_013_CKDN230006113-1A_H5LY7DSX7_L1_1.fq.gz
NOCA_013_CKDN230006113-1A_H5LY7DSX7_L1_2.fq.gz
PYRR_003_1.fq.gz
PYRR_003_2.fq.gz
PYRR_004_CKDN230006115-1A_H5LY7DSX7_L1_1.fq.gz
PYRR_004_CKDN230006115-1A_H5LY7DSX7_L1_2.fq.gz
PYRR_006_CKDN230006116-1A_H5LY7DSX7_L1_1.fq.gz
PYRR_006_CKDN230006116-1A_H5LY7DSX7_L1_2.fq.gz
PYRR_007_1.fq.gz
PYRR_007_2.fq.gz
PYRR_009_CKDN230006118-1A_H5LY7DSX7_L1_1.fq.gz
PYRR_009_CKDN230006118-1A_H5LY7DSX7_L1_2.fq.gz
PYRR_011_CKDN230006119-1A_H5LY7DSX7_L2_1.fq.gz
PYRR_011_CKDN230006119-1A_H5LY7DSX7_L2_2.fq.gz
UWBM_100619_CKDN230006120-1A_H5LY7DSX7_L2_1.fq.gz
UWBM_100619_CKDN230006120-1A_H5LY7DSX7_L2_2.fq.gz
UWBM_100620_CKDN230006125-1A_H5LY7DSX7_L2_1.fq.gz
UWBM_100620_CKDN230006125-1A_H5LY7DSX7_L2_2.fq.gz
UWBM_100621_CKDN230006122-1A_H5LY7DSX7_L2_1.fq.gz
UWBM_100621_CKDN230006122-1A_H5LY7DSX7_L2_2.fq.gz
UWBM_103345_CKDN230006123-1A_H5LY7DSX7_L2_1.fq.gz
UWBM_103345_CKDN230006123-1A_H5LY7DSX7_L2_2.fq.gz
UWBM_103346_1.fq.gz
UWBM_103346_2.fq.gz
UWBM_77548_CKDN230006130-1A_H5LY7DSX7_L2_1.fq.gz
UWBM_77548_CKDN230006130-1A_H5LY7DSX7_L2_2.fq.gz
UWBM_77718_CKDN230006127-1A_H5LY7DSX7_L2_1.fq.gz
UWBM_77718_CKDN230006127-1A_H5LY7DSX7_L2_2.fq.gz
UWBM_77780_CKDN230006129-1A_H5LY7DSX7_L2_1.fq.gz
UWBM_77780_CKDN230006129-1A_H5LY7DSX7_L2_2.fq.gz
UWBM_77781_CKDN230006126-1A_H5HK7DSX7_L1_1.fq.gz
UWBM_77781_CKDN230006126-1A_H5HK7DSX7_L1_2.fq.gz
UWBM_77856_1.fq.gz
UWBM_77856_2.fq.gz
UWBM_77978_CKDN230006124-1A_H5LY7DSX7_L2_1.fq.gz
UWBM_77978_CKDN230006124-1A_H5LY7DSX7_L2_2.fq.gz

while read -r bird;
do
cp $bird ../condensed_fastas/
done < filenames.txt

mv MSB_25201_CKDN230006131-1A_H5LY7DSX7_L2_1.fq.gz MSB25201_1.fq.gz
mv MSB_25201_CKDN230006131-1A_H5LY7DSX7_L2_2.fq.gz MSB25201_2.fq.gz
mv NOCA_003_CKDN230006108-1A_H5LY7DSX7_L1_1.fq.gz NOCA003_1.fq.gz
mv NOCA_003_CKDN230006108-1A_H5LY7DSX7_L1_2.fq.gz NOCA003_2.fq.gz
mv NOCA_004_1.fq.gz NOCA004_1.fq.gz
mv NOCA_004_2.fq.gz NOCA004_2.fq.gz
mv NOCA_006_CKDN230006110-1A_H5LY7DSX7_L1_1.fq.gz NOCA006_1.fq.gz
mv NOCA_006_CKDN230006110-1A_H5LY7DSX7_L1_2.fq.gz NOCA006_2.fq.gz
mv NOCA_008_CKDN230006111-1A_H5MT2DSX7_L1_1.fq.gz NOCA008_1.fq.gz
mv NOCA_008_CKDN230006111-1A_H5MT2DSX7_L1_2.fq.gz NOCA008_2.fq.gz
mv NOCA_012_CKDN230006112-1A_H5LY7DSX7_L1_1.fq.gz NOCA012_1.fq.gz
mv NOCA_012_CKDN230006112-1A_H5LY7DSX7_L1_2.fq.gz NOCA012_2.fq.gz
mv NOCA_013_CKDN230006113-1A_H5LY7DSX7_L1_1.fq.gz NOCA013_1.fq.gz
mv NOCA_013_CKDN230006113-1A_H5LY7DSX7_L1_2.fq.gz NOCA013_2.fq.gz
mv PYRR_003_1.fq.gz PYRR003_1.fq.gz
mv PYRR_003_2.fq.gz PYRR003_2.fq.gz
mv PYRR_004_CKDN230006115-1A_H5LY7DSX7_L1_1.fq.gz PYRR004_1.fq.gz
mv PYRR_004_CKDN230006115-1A_H5LY7DSX7_L1_2.fq.gz PYRR004_2.fq.gz
mv PYRR_006_CKDN230006116-1A_H5LY7DSX7_L1_1.fq.gz PYRR006_1.fq.gz
mv PYRR_006_CKDN230006116-1A_H5LY7DSX7_L1_2.fq.gz PYRR006_2.fq.gz
mv PYRR_007_1.fq.gz PYRR007_1.fq.gz
mv PYRR_007_2.fq.gz PYRR007_2.fq.gz
mv PYRR_009_CKDN230006118-1A_H5LY7DSX7_L1_1.fq.gz PYRR009_1.fq.gz
mv PYRR_009_CKDN230006118-1A_H5LY7DSX7_L1_2.fq.gz PYRR009_2.fq.gz
mv PYRR_011_CKDN230006119-1A_H5LY7DSX7_L2_1.fq.gz PYRR011_1.fq.gz
mv PYRR_011_CKDN230006119-1A_H5LY7DSX7_L2_2.fq.gz PYRR011_2.fq.gz
mv UWBM_100619_CKDN230006120-1A_H5LY7DSX7_L2_1.fq.gz UWBM100619_1.fq.gz
mv UWBM_100619_CKDN230006120-1A_H5LY7DSX7_L2_2.fq.gz UWBM100619_2.fq.gz
mv UWBM_100620_CKDN230006125-1A_H5LY7DSX7_L2_1.fq.gz UWBM100620_1.fq.gz
mv UWBM_100620_CKDN230006125-1A_H5LY7DSX7_L2_2.fq.gz UWBM100620_2.fq.gz
mv UWBM_100621_CKDN230006122-1A_H5LY7DSX7_L2_1.fq.gz UWBM100621_1.fq.gz
mv UWBM_100621_CKDN230006122-1A_H5LY7DSX7_L2_2.fq.gz UWBM100621_2.fq.gz
mv UWBM_103345_CKDN230006123-1A_H5LY7DSX7_L2_1.fq.gz UWBM103345_1.fq.gz
mv UWBM_103345_CKDN230006123-1A_H5LY7DSX7_L2_2.fq.gz UWBM103345_2.fq.gz
mv UWBM_103346_1.fq.gz UWBM103346_1.fq.gz
mv UWBM_103346_2.fq.gz UWBM103346_2.fq.gz
mv UWBM_77548_CKDN230006130-1A_H5LY7DSX7_L2_1.fq.gz UWBM77548_1.fq.gz
mv UWBM_77548_CKDN230006130-1A_H5LY7DSX7_L2_2.fq.gz UWBM77548_2.fq.gz
mv UWBM_77718_CKDN230006127-1A_H5LY7DSX7_L2_1.fq.gz UWBM77718_1.fq.gz
mv UWBM_77718_CKDN230006127-1A_H5LY7DSX7_L2_2.fq.gz UWBM77718_2.fq.gz
mv UWBM_77780_CKDN230006129-1A_H5LY7DSX7_L2_1.fq.gz UWBM77780_1.fq.gz
mv UWBM_77780_CKDN230006129-1A_H5LY7DSX7_L2_2.fq.gz UWBM77780_2.fq.gz
mv UWBM_77781_CKDN230006126-1A_H5HK7DSX7_L1_1.fq.gz UWBM77781_1.fq.gz
mv UWBM_77781_CKDN230006126-1A_H5HK7DSX7_L1_2.fq.gz UWBM77781_2.fq.gz
mv UWBM_77856_1.fq.gz UWBM77856_1.fq.gz
mv UWBM_77856_2.fq.gz UWBM77856_2.fq.gz
mv UWBM_77978_CKDN230006124-1A_H5LY7DSX7_L2_1.fq.gz UWBM77978_1.fq.gz
mv UWBM_77978_CKDN230006124-1A_H5LY7DSX7_L2_2.fq.gz UWBM77978_2.fq.gz

ls condensed_fastas/ | awk -F "_" '{print $1}' | sort -u > sampleids.txt

#!/bin/bash

#SBATCH --job-name=trimming
#SBATCH --ntasks=12
#SBATCH --nodes=1             
#SBATCH --time=60:00:00   
#SBATCH --partition=standard
#SBATCH --account=mcnew
#SBATCH --mem-per-cpu=200gb
#SBATCH --mail-type=ALL
#SBATCH --mail-user=dannyjackson@arizona.edu
#SBATCH --output=output.#SBATCH --job-name=trimming.%j



cd ~/programs/Trimmomatic

echo "Beginning trimming for "$ID>>/xdisk/mcnew/dannyjackson/cardinals/scripts/output/trim_log.txt

while read -r ID;
do
  java -jar ~/programs/Trimmomatic/dist/jar/trimmomatic-0.40-rc1.jar PE -threads 12 \
/xdisk/mcnew/dannyjackson/cardinals/condensed_fastas/"$ID"_1.fq.gz  /xdisk/mcnew/dannyjackson/cardinals/condensed_fastas/"$ID"_2.fq.gz  \
-baseout /xdisk/mcnew/dannyjackson/cardinals/trimmed_fastas/"$ID"_trimmed.fq.gz \
LEADING:20 TRAILING:20 SLIDINGWINDOW:4:20 MINLEN:90>>/xdisk/mcnew/dannyjackson/cardinals/scripts/output/trim_log.txt


done < /xdisk/mcnew/dannyjackson/cardinals/sampleids.txt



sbatch 1_trimming.sh 
Submitted batch job 10442817

